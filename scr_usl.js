var check1=document.getElementById('all-services-item-1');
$(check1).on('click', function () {
    if ( $(this).prop('checked') === true ) {
        price+=217;
        array.push(1);
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price; 
      document.getElementById('ser').value = array;   }
    else{
        price-=217;
        array.pop(1);
      document.getElementById('total-price__info').innerHTML = price; 
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;   }
});

var check2=document.getElementById('all-services-item-2');
$(check2).on('click', function () {
    if ( $(this).prop('checked') === true ) {
        array.push(2);
        price+=87;
      document.getElementById('total-price__info').innerHTML = price; 
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;  }
    else{
        price-=87;
        array.pop(2);
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;    }
});
var check3=document.getElementById('all-services-item-3');
$(check3).on('click', function () {
    if ( $(this).prop('checked') === true ) {
        array.push(3);
        price+=106;
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;    }
    else{
        price-=106;
        array.pop(3);
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;    }
});

var check4=document.getElementById('all-services-item-4');
$(check4).on('click', function () {    
    if ( $(this).prop('checked') === true ) {
        array.push(4);
        price+=157;
      document.getElementById('total-price__info').innerHTML = price; 
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;   }
    else{
        price-=157;
        array.pop(4);
      document.getElementById('total-price__info').innerHTML = price; 
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;   }
});
var check5=document.getElementById('all-services-item-5');
$(check5).on('click', function () {    
    if ( $(this).prop('checked') === true ) {
        array.push(5);
        price+=314;
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price; 
      document.getElementById('ser').value = array;   }
    else{
        price-=314;
        array.pop(5);
      document.getElementById('total-price__info').innerHTML = price; 
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;   }
});
var check6=document.getElementById('all-services-item-6');
$(check6).on('click', function () {    
    if ( $(this).prop('checked') === true ) {
        array.push(6);
        price+=722;
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;    }
    else{
        price-=722;
        array.pop(6);
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;    }
});

var check7=document.getElementById('all-services-item-7');
$(check7).on('click', function () {    
    if ( $(this).prop('checked') === true ) {
        array.push(7);
        price+=77;
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;    }
    else{
        price-=77;
        array.pop(7);
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price; 
      document.getElementById('ser').value = array;   }
});
var check8=document.getElementById('all-services-item-8');
$(check8).on('click', function () {    
    if ( $(this).prop('checked') === true ) {
        array.push(8);
        price+=122;
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price; 
      document.getElementById('ser').value = array;   }
    else{
        price-=122;
        array.pop(8);
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;    }
});
var check9=document.getElementById('all-services-item-9');
$(check9).on('click', function () {    
    if ( $(this).prop('checked') === true ) {
        array.push(9);
        price+=117;
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price; 
      document.getElementById('ser').value = array;   }
    else{
        price-=117;
        array.pop(9);
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price; 
      document.getElementById('ser').value = array;   }
});
var check10=document.getElementById('all-services-item-10');
$(check10).on('click', function () {    
    if ( $(this).prop('checked') === true ) {
        array.push(10);
        price+=409;
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price; 
      document.getElementById('ser').value = array;   }
    else{
        price-=409;
        array.pop(10);
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;    }
});
var check11=document.getElementById('all-services-item-11');
$(check11).on('click', function () {    
    if ( $(this).prop('checked') === true ) {
        array.push(11);
        price+=67;
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price;  
      document.getElementById('ser').value = array;  }
    else{
        price-=67;
        array.pop(11);
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;    }
});
var check14=document.getElementById('all-services-item-14');
$(check14).on('click', function () {    
    if ( $(this).prop('checked') === true ) {
        array.push(14);
        price+=237;
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;    }
    else{
        price-=237;
        array.pop(14);
      document.getElementById('total-price__info').innerHTML = price; 
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;   }
});
var check15=document.getElementById('all-services-item-15');
$(check15).on('click', function () {    
    if ( $(this).prop('checked') === true ) {
        array.push(15);
        price+=37;
      document.getElementById('total-price__info').innerHTML = price;  
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;  }
    else{
        price-=37;
        array.pop(15);
      document.getElementById('total-price__info').innerHTML = price; 
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;   }
});
var check12=document.getElementById('all-services-item-12');
$(check12).on('click', function () {    
    if ( $(this).prop('checked') === true ) {
        array.push(12);
        price+=3017;
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;    }
    else{
        price-=3017;
        array.pop(12);
      document.getElementById('total-price__info').innerHTML = price;
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;    }
});
var check13=document.getElementById('all-services-item-13');
$(check13).on('click', function () {    
    if ( $(this).prop('checked') === true ) {
        array.push(13);
        price+=4702;
        document.getElementById('total-price__info').innerHTML = price; 
        document.getElementById('total-price_info').value = price;
        document.getElementById('ser').value = array;  }   
        else{
        price-=4702;
        array.pop(13);
      document.getElementById('total-price__info').innerHTML = price; 
      document.getElementById('total-price_info').value = price;
      document.getElementById('ser').value = array;   }
});
$('#autopay').attr('name', 'a_pay'); 
$('#autopay').attr('value', '0');
var apay=0;
var apay1=0;
var apay2=0;
var apay3=0;
var apay4=0;
var apay5=0;
var autopay= document.getElementById('autopay');
$(autopay).on('change', function () {
   if($(this).prop('checked')===true){
    $('#autopay').removeAttr('name');
    $('#autopay').removeAttr('value');
    $('#autopay').attr('name', 'a_pay'); 
    $('#autopay').attr('value', '1');
    apay=1;
    //console.log("apay="+apay);
   }
   else{
    $('#autopay').removeAttr('name');
    $('#autopay').removeAttr('value');
    $('#autopay').attr('name', 'a_pay'); 
    $('#autopay').attr('value', '0');
    apay=0;
    //console.log("apay="+apay);
   }
});
 var dateMonth = document.getElementById('date-podpiska-month');
 var dateYear = document.getElementById('date-podpiska-year');
$('#per').attr('name', 'tt'); 
$('#per').attr('value', '0');
 $(dateMonth).on('change',function(){
    if($(this).prop('checked')===true){
        $(dateYear).prop('checked', false); 
        document.getElementById("new-pr").remove();
        document.getElementById("total-price__info").className = "";
        $('#per').removeAttr('name');
        $('#per').removeAttr('value');
        price=price/0.63/12;
        price=Math.round(price); 
        document.getElementById('total-price__info').innerHTML = price;
        document.getElementById('total-price_info').value = price; 
        t=0;
        $('#per').attr('name', 'tt'); 
        $('#per').attr('value', '0');
        price=Math.round(price); 
        document.getElementById('total-price__info').innerHTML = price;
        document.getElementById('total-price_info').value = price;
    }
    else{
        $(dateYear).prop('checked', true);
        $('#per').removeAttr('name');
        $('#per').removeAttr('value');
    }
 });
 $(dateYear).on('change',function(){
    if($(this).prop('checked')===true){
        $(dateMonth).prop('checked', false);
        $(dateYear).prop('checked', true);
        $('#per').removeAttr('name');
        $('#per').removeAttr('value');
        $('#per').attr('name', 'tt'); 
        $('#per').attr('value', '1');
        document.getElementById('total-price__info').innerHTML = price*12;

        t=1;
        x=price*0.63*12;
        var priceSale=Math.round(x); 
        //console.log(priceSale); 
        var el=document.getElementById('total-price__info');
        el.classList.add("connected-services-price-old");
        var el1=document.getElementById('to-pay-value');
        el1.innerHTML+='<div class="new-pr" id="new-pr">'+priceSale+' ₽</div>';
        document.getElementById('total-price_info').value = priceSale;
        price=priceSale;
    }
    else {
        $(dateMonth).prop('checked', true);
        document.getElementById("new-pr").remove();
        document.getElementById("total-price__info").className = "";
        $('#per').removeAttr('name');
        $('#per').removeAttr('value');
        price=price/0.63/12;
        price=Math.round(price); 
        document.getElementById('total-price__info').innerHTML = price;
        document.getElementById('total-price_info').value = price;
        
        
    }
 });
elem.onclick=function(){
    console.log(apay);
    if (apay==1){
        alert("Вы не можете подключить услугу автоплатежа для данного вида оплаты");
        document.location.reload();
    }
    else{
        var data = {'total-price__info' : price, 'myarray': uniq(array), 'time': t};
        
        //console.log(data);
        $.ajax({
            method:'POST',
            dataType: 'json',
            url: '/ajax/ajax_usl.php', 
            cache: false,
            async: true,
            data: data,
            success: function(data) {                
                if (data.needToReload === 1) location.reload();
                if (data.result === 'success') {                    
                    var header = "",
                        body = '',
                        loader = false,
                        modalClass = 'modal-result';
                    prepareModal(modalClass, header, body, loader);
                    document.location.reload();
                    return false;                    
                } else if (data.result === 'fail') {
                  alert("Не достаточно средств на счёте");
                    var header = 'Услуги не были подключены',                   
                    body = '<p>Попробуйте добавить услуги заново</p>',
                    loader = false,
                    modalClass = 'modal-result';
                    prepareModal(modalClass, header, body, loader);
                    document.location.reload();
                    return false;
                }
                document.location.reload();
            },
            error: function(XMLHttpRequest, errorStr) {alert('Ошибка! Обновите страницу (F5+Ctrl) и попробуйте снова, либо обратитесь в службу поддержки.' + errorStr);}            
          });          
        return false;
    }
};
